# Philosophers Project - Edge Cases

## 1. 특수한 철학자 수 케이스

### 1.1. 철학자 1명
```bash
./philo 1 800 200 200
```
- **상황**: 포크가 1개밖에 없어 식사 불가능
- **예상 결과**: 철학자는 time_to_die 시간 후에 죽어야 함
- **처리 방법**:
```c
if (data->num_of_philos == 1)
{
    print_status(data, 1, "has taken a fork");
    smart_sleep(data->time_to_die, data);
    print_status(data, 1, "died");
    return (1);
}
```

### 1.2. 철학자 수가 매우 많은 경우
```bash
./philo 200 800 200 200
```
- **상황**: 시스템 리소스(스레드, 뮤텍스) 한계에 도달할 수 있음
- **처리 방법**: 
  - 최대 철학자 수 제한 설정
  - 시스템 리소스 할당 실패 시 적절한 에러 처리

## 2. 시간 관련 에지 케이스

### 2.1. 매우 짧은 시간
```bash
./philo 4 0 0 0
./philo 4 1 1 1
```
- **상황**: 시간이 0이거나 매우 작은 경우
- **처리 방법**:
  - 0 또는 음수 시간은 에러 처리
  - 매우 작은 시간은 usleep의 최소 단위(약 1ms) 고려

### 2.2. 매우 긴 시간
```bash
./philo 4 2147483647 200 200
```
- **상황**: 정수 오버플로우 가능성
- **처리 방법**:
  - long long 자료형 사용
  - 시간 계산 시 오버플로우 체크

## 3. 입력값 검증 케이스

### 3.1. 잘못된 인자 수
```bash
./philo             # 인자 없음
./philo 4           # 인자 부족
./philo 4 800 200   # 인자 부족
./philo 4 800 200 200 5 6  # 인자 과다
```
- **처리 방법**:
```c
if (argc != 5 && argc != 6)
{
    printf("Error: wrong number of arguments\n");
    return (1);
}
```

### 3.2. 잘못된 인자 값
```bash
./philo -4 800 200 200     # 음수 철학자
./philo 4 -800 200 200     # 음수 시간
./philo 4 800 200 200 -5   # 음수 식사 횟수
./philo a 800 200 200      # 숫자가 아닌 입력
```
- **처리 방법**:
```c
// ft_atoi에서 오버플로우와 문자열 검증
int ft_atoi(const char *str)
{
    // 숫자가 아닌 문자 체크
    // 오버플로우 체크
    // 음수 체크
}
```

## 4. 시스템 리소스 관련 케이스

### 4.1. 메모리 할당 실패
```c
// 메모리 할당 실패 처리
if (!(data->forks = malloc(sizeof(pthread_mutex_t) * data->num_of_philos)))
{
    clean_program(data);
    return (1);
}
```

### 4.2. 뮤텍스 초기화 실패
```c
if (pthread_mutex_init(&data->forks[i], NULL))
{
    // 이전에 초기화된 뮤텍스들 정리
    clean_program(data);
    return (1);
}
```

### 4.3. 스레드 생성 실패
```c
if (pthread_create(&data->philos[i].thread, NULL, philosopher, &data->philos[i]))
{
    // 이전에 생성된 스레드들 정리
    clean_program(data);
    return (1);
}
```

## 5. 타이밍 관련 에지 케이스

### 5.1. 죽음과 식사 시점이 매우 가까운 경우
```bash
./philo 4 310 300 300  # 죽음 시간과 식사 시간이 매우 근접
```
- **처리 방법**:
  - 식사 시간 업데이트와 죽음 체크를 뮤텍스로 보호
  - 정확한 시간 측정을 위한 usleep 사용 최소화

### 5.2. 모든 철학자가 동시에 식사를 시도하는 경우
```bash
./philo 4 400 200 200
```
- **처리 방법**:
  - 홀수/짝수 철학자 번호에 따른 시차 부여
  - 포크 잡는 순서 최적화

## 6. 프로그램 종료 관련 케이스

### 6.1. 모든 철학자가 필요한 만큼 식사한 경우
```bash
./philo 4 800 200 200 5  # 5회 식사 후 종료
```
- **처리 방법**:
  - 모든 철학자의 식사 횟수 체크
  - 안전한 프로그램 종료 보장

### 6.2. 한 철학자가 죽은 경우
- **처리 방법**:
  - 죽음 상태를 모든 스레드가 즉시 인식
  - 다른 철학자들의 안전한 종료 보장
  - 모든 자원(뮤텍스, 메모리) 정리

각 에지 케이스에 대해 적절한 처리가 되어 있는지 테스트하고, 프로그램이 예상대로 동작하는지 확인해야 합니다.
